# Google Calendar Peering (Work-Life Edition)

仕事（Work）と私生活（Life）、2つの独立したGoogleカレンダーを相互接続（Peering）し、**理想の「ワークライフバランス」をサポート** Google Apps Script (GAS) ツールです。

サーバー不要、完全無料で動作し、プライバシーと「個人の意思」に配慮した設計になっています。

## 🎯 コンセプト - Why "Peering"?

本ツールが「Sync（同期）」ではなく**「Peering（ピアリング）」**を名乗るのには理由があります。

単に予定をコピーして共有するだけの「受動的な同期」ではありません。
これは、**互いの領域（もしくはAS）の独立性を保ったまま、自分が公開したい「空き時間」と「ブロックしたい時間」だけを、自分のルールの元で相互に広報（Advertise）する「能動的なピアリング」**です。

いわば、**「自分の時間を守るための、双方のワガママ（Opinionated）な要求を良きに取り計らうルータ」**として機能します。

* **Work domain → Life domain:**
    * **広報内容:** 家族やパートナー、あるいは自分自身のために確保できる「休日・祝日」の情報。
    * **目的:** 仕事の予定で埋まりがちなカレンダーの中に、**生活（Life）のための「空白」を明確化**し、プライベートな計画を立てやすくします。

* **Life domain → Work domain:**
    * **広報内容:** 通院、役所手続き、あるいは「絶対に邪魔されたくない趣味の時間」など、譲れない「私用（ブロック）」の情報。
    * **目的:** 具体的な内容は隠蔽（Mask）したまま「休暇」として共有し、**職場からの会議招待を回避**します。

## 🚀 特徴

* **Work-Life Balance First:** 「仕事」と「人生」を対等なドメイン（もしくはAS）として扱います。
* **完全無料 & サーバーレス:** Google Apps Script (GAS) だけで完結し、常時稼働サーバーは不要です。
* **Work -> Life (自動共有):** 休日・祝日の仕事予定を、自動でLifeカレンダーへ連携します。
* **Life -> Work (マスク共有):** 平日の私用を、仕事カレンダーへ「休暇」とマスクして共有します。内容は表示されません。
* **タグによる手動制御:** `[Life]` / `[Work]` タグで、自動判定に関わらず同期対象を指定できます。
* **通知対応:** Discord / Google Chat へ変更ログを通知できます。
* **DRY_RUNモード:** 実際の変更を適用せず、動作確認が可能です。

## 🛠 セットアップ

### 1. プロジェクトの作成
Google Apps Script プロジェクトを新規作成するか、`clasp` でローカルに clone してください。

### 2. コードのデプロイ
`Code.js` の内容をコピー＆ペーストするか、push してください。

### 3. スクリプトプロパティの設定
GASエディタの「プロジェクトの設定」>「スクリプト プロパティ」に以下を設定します。

#### 必須プロパティ

| プロパティ名 | 説明 | 例 |
| --- | --- | --- |
| `WORK_CALENDAR_ID` | 仕事のカレンダーID | `user@company.com` |
| `LIFE_CALENDAR_ID` | 私生活のカレンダーID | `user@gmail.com` |

#### オプションプロパティ

| プロパティ名 | 説明 | デフォルト値 |
| --- | --- | --- |
| `DISCORD_WEBHOOK_URL` | Discord通知用Webhook URL | (空) |
| `GOOGLE_CHAT_WEBHOOK_URL` | Google Chat通知用Webhook URL | (空) |
| `SYNC_KEYWORDS_TO_LIFE` | Work→Life同期対象キーワード（カンマ区切り） | `[Life],出張,夜勤` |
| `SYNC_KEYWORDS_TO_WORK` | Life→Work同期対象キーワード（カンマ区切り） | `[Work],通院,役所` |
| `MASK_WORK_TO_LIFE` | Work→Life同期時にタイトルをマスクするか | `false` |
| `MASK_TITLE_WORK` | Work→Lifeマスク時のタイトル | `仕事` |
| `MASK_TITLE_LIFE` | Life→Workマスク時のタイトル | `休暇` |
| `SYNC_DAYS` | 同期対象期間（日数） | `30` |
| `WEEKEND_DAYS` | 週末とみなす曜日（0=日, 6=土） | `0,6` |
| `HOLIDAY_IGNORE_LIST` | 祝日判定から除外するイベント | `節分,バレンタイン,雛祭り,母の日,父の日,七夕,ハロウィン,クリスマス` |
| `CUSTOM_HOLIDAY_KEYWORDS` | 職場独自の休日キーワード<br>例： `創立記念日` | (空) |
| `DRY_RUN` | テストモード（true で変更を適用しない） | `false` |

### 使い方 (キーワード同期 & マスク)

| 設定 | 動作 |
|--------|------|
| **SYNC_KEYWORDS_TO_LIFE** | 指定したキーワード（例: `夜勤`）を含む予定は、自動でLifeカレンダーへ共有します。 |
| **SYNC_KEYWORDS_TO_WORK** | 指定したキーワード（例: `通院`）を含む予定は、Workカレンダーへマスクして共有します。 |
| **MASK_WORK_TO_LIFE** | `true` にすると、Work→Lifeの同期時にタイトルが `MASK_TITLE_WORK`（例: `仕事`）に置き換わります。<br>※ NDA案件や🕵️‍♂️🥜な任務など(#9)、家族にも秘密にしたい予定に最適です。 |

### 4. トリガー設定
GASのトリガー設定画面で、`main` 関数を「時間主導型（例: 1時間おき）」で設定してください。

## 📋 使い方

### 自動同期（デフォルト動作）

| ケース | 動作 |
|--------|------|
| Work: 土日・祝日の予定 | → Life（自動、そのまま表示） |
| Work: 職場独自休日の予定 | → Life（自動、そのまま表示） |
| Life: 平日の予定 | → Work（自動、「休暇」として表示） |

### タグによる手動制御

| ケース | 動作 |
|--------|------|
| Work: `[Life]` タグ付きの予定 | → Life（曜日に関わらず同期） |
| Life: `[Work]` タグ付きの予定 | → Work（曜日に関わらず同期、マスク） |

### DRY_RUNモード

初回セットアップ時や設定変更時は、`DRY_RUN=true` で動作確認することを推奨します。

```
[DRY_RUN] ✨ 新規作成予定: 会議 (01/15 10:00)
[DRY_RUN] 🗑️ 削除予定: 休暇 (01/20 00:00)
```

## ⚠️ 前提条件
* 接続したい2つのカレンダーアカウント間で、**相互に「予定の変更権限」** の共有設定が必要です。

## License
MIT
